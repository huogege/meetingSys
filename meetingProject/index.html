<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name=viewport content="width=device-width,initial-scale=0.5,maximum-scale=0.5,minimum-scale=0.5,user-scalable=0">
    <title>y</title>
    <link rel="stylesheet" href="./static/css/reset.css">
    <script src="./static/js/qrcode.lib.min.js"></script>
    <script src="https://cdn.bootcss.com/zepto/1.0rc1/zepto.min.js"></script>
  </head>
  <body>
    <div id="app"></div>
    <div class="notUser" style="position:absolute;left:0;top:0;width:100%;height:100%;background:#fff;display:none">
      <h1 style="font-size:.3rem;line-height: 1rem;text-indent: .3rem;">后台名单中未找到您，请联系后台管理员！</h1>
    </div>
    <!-- built files will be auto injected -->
    <script type=text/javascript>var deviceWidth = document.documentElement.clientWidth;document.documentElement.style.fontSize = deviceWidth / 7.5 + 'px';</script>
    <script>
        
    </script>
    <script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
    <!-- <script type="text/javascript" src="config/config.js"></script> -->
    <script type="text/javascript" src="js/jbase64.js"></script>
    <script type="text/javascript" src="js/common.js"></script>
    <script type="text/javascript">
      var IsAPP =  false;

      function getToken(params) { //获取token
            sessionStr = params;
            var sessionObj = eval("(" + sessionStr + ")");
            alert(sessionObj.sessionId)
            alert(sessionObj.token)
            alert(sessionObj.phone)
            if(sessionObj.phone == undefined){  
                  $(".notUser").show();
                  alert("后台系统没有您的名单，请联系管理员添加！");
                  return false;
            }else{
                var userInfor = {};
                userInfor.sessionId = sessionObj.sessionId;
                userInfor.token = sessionObj.token;
                userInfor.phone = sessionObj.phone;
                localStorage.setItem('userInfor',JSON.stringify(userInfor));
                $(".notUser").hide();
                alert( userInfor.phone)
              }
      }
      var timer = setInterval(function(){
        try { //判断是否在APP打开
            if(window.AppJsObj){
              clearInterval(timer);
              localStorage.removeItem('userInfor');
              window.AppJsObj.appSessionToken("getToken", 2);
              IsAPP = true;
              getToken()
            }	          
          } catch(e) {
            IsAPP = false;
           // alert("请在app中打开网页！")
          }	
      },"200");

      
    
      function testLocalstorage(){
        var sessionObj = {
          sessionId:'sessionId_123',
          token:'token_123',
          phone:'18996394903'
        }
        if(localStorage.userInfor){
              localStorage.removeItem("userInfor")
            }else{
              var userInfor = {};
              userInfor.sessionId = sessionObj.sessionId;
              userInfor.token = sessionObj.token;
              userInfor.phone = sessionObj.phone;
              localStorage.setItem('userInfor',JSON.stringify(userInfor));
              if(sessionObj.phone ==''){
                  alert("您当前没有注册，请注册再登录！")
              }
            } 
      }
      //testLocalstorage()
     //setTimeout(function(){testLocalstorage()}) 
      
    </script> 
  </body>
</html>
